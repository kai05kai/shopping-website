# Server配置
server.port=8080
server.servlet.context-path=/

# 数据库配置
spring.datasource.url=jdbc:mysql://localhost:3306/shopping_db?useSSL=false&serverTimezone=Asia/Shanghai&characterEncoding=utf8&allowPublicKeyRetrieval=true
spring.datasource.username=shopping_app
spring.datasource.password=!@#Huhongxin5

# JPA配置
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false  # 生产环境设为false减少日志
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

# Thymeleaf配置
spring.thymeleaf.cache=true  # 生产环境开启缓存
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8

# 文件上传配置
spring.servlet.multipart.max-file-size=5MB  # 减小到5MB以降低服务器压力
spring.servlet.multipart.max-request-size=5MB

# 应用名称
spring.application.name=shopping-website

# 上传文件配置
app.upload.dir=/home/shopping-website/uploads

# 生产环境优化配置
spring.thymeleaf.check-template-location=true
spring.resources.add-mappings=true
spring.resources.cache.period=31536000  # 静态资源缓存一年
spring.resources.chain.cache=true
spring.resources.chain.enabled=true
spring.resources.chain.gzipped=true
spring.resources.chain.strategy.content.enabled=true
spring.resources.chain.strategy.content.paths=/**

# 日志配置 (生产环境减少日志输出)
logging.level.com.example.shopping_website=INFO
logging.level.org.springframework.web=WARN
logging.level.org.hibernate=WARN
logging.level.root=WARN

# 数据库连接池优化 (针对低配置服务器)
spring.datasource.hikari.maximum-pool-size=5  # 减小连接池大小
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# 关闭开发模式
spring.devtools.restart.enabled=false